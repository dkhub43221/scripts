local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")
local StarterGui = game:GetService("StarterGui")
local player = Players.LocalPlayer
local correctKey = "Winter"

-- Allowed GameId
local allowedGameId = "102500767640476"

-- Script URLs mapped by GameId
local gameScripts = {
    ["102500767640476"] = "https://raw.githubusercontent.com/dkhub43221/scripts/refs/heads/main/miami%20streets"
}

-- GUI setup
local gui = Instance.new("ScreenGui")
gui.Name = "DK_HUB_GUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- Blur effect
local blur = Instance.new("BlurEffect")
blur.Size = 0
blur.Parent = Lighting
TweenService:Create(blur, TweenInfo.new(0.5), {Size = 24}):Play()

-- Main frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 360, 0, 180)
frame.Position = UDim2.new(0.5, -180, 0.5, -90)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderSizePixel = 0
frame.Parent = gui

local outline = Instance.new("UIStroke")
outline.Thickness = 3
outline.Color = Color3.fromRGB(0, 255, 0)
outline.Parent = frame

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = frame

-- Title with typing effect
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundTransparency = 1
title.Text = ""
title.TextColor3 = Color3.fromRGB(0, 255, 0)
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.Parent = frame

local function typeTitle(text)
    title.Text = ""
    for i = 1, #text do
        title.Text = string.sub(text, 1, i)
        task.wait(0.1)
    end
end

-- Loop typing effect
task.spawn(function()
    while true do
        typeTitle("DK's HUB")
        task.wait(0.5)
        typeTitle("")
        task.wait(0.5)
    end
end)

-- Close button
local close = Instance.new("TextButton")
close.Size = UDim2.new(0, 30, 0, 30)
close.Position = UDim2.new(1, -35, 0, 5)
close.BackgroundTransparency = 1
close.Text = "X"
close.TextColor3 = Color3.fromRGB(255, 255, 255)
close.TextScaled = true
close.Font = Enum.Font.GothamBold
close.Parent = frame
close.MouseButton1Click:Connect(function()
    gui:Destroy()
    blur:Destroy()
end)

-- Premium line
local prem = Instance.new("TextLabel")
prem.Size = UDim2.new(1, -20, 0, 20)
prem.Position = UDim2.new(0, 10, 0, 45)
prem.BackgroundTransparency = 1
prem.Text = "Donâ€™t want to wait? Purchase Premium!"
prem.TextColor3 = Color3.fromRGB(255, 255, 255)
prem.TextSize = 14
prem.Font = Enum.Font.GothamSemibold
prem.Parent = frame
prem.MouseEnter:Connect(function() prem.TextColor3 = Color3.fromRGB(0, 255, 0) end)
prem.MouseLeave:Connect(function() prem.TextColor3 = Color3.fromRGB(255, 255, 255) end)

-- Key TextBox
local box = Instance.new("TextBox")
box.Size = UDim2.new(1, -40, 0, 35)
box.Position = UDim2.new(0, 20, 0, 70)
box.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
box.PlaceholderText = "Enter your key here..."
box.TextColor3 = Color3.fromRGB(255, 255, 255)
box.PlaceholderColor3 = Color3.fromRGB(160, 160, 160)
box.Font = Enum.Font.Gotham
box.TextSize = 14
box.Parent = frame
local boxCorner = Instance.new("UICorner")
boxCorner.CornerRadius = UDim.new(0, 6)
boxCorner.Parent = box

-- Buttons container
local buttonHolder = Instance.new("Frame")
buttonHolder.Size = UDim2.new(1, -40, 0, 35)
buttonHolder.Position = UDim2.new(0, 20, 0, 115)
buttonHolder.BackgroundTransparency = 1
buttonHolder.Parent = frame

-- Check key button
local check = Instance.new("TextButton")
check.Size = UDim2.new(0.48, 0, 1, 0)
check.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
check.TextColor3 = Color3.fromRGB(255, 255, 255)
check.Font = Enum.Font.GothamBold
check.Text = "Check Key"
check.TextSize = 14
check.Parent = buttonHolder
local checkCorner = Instance.new("UICorner")
checkCorner.CornerRadius = UDim.new(0, 6)
checkCorner.Parent = check

-- Get key button
local getkey = Instance.new("TextButton")
getkey.Size = UDim2.new(0.48, 0, 1, 0)
getkey.Position = UDim2.new(0.52, 0, 0, 0)
getkey.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
getkey.TextColor3 = Color3.fromRGB(255, 255, 255)
getkey.Font = Enum.Font.GothamBold
getkey.Text = "Get Key!"
getkey.TextSize = 14
getkey.Parent = buttonHolder
local getCorner = Instance.new("UICorner")
getCorner.CornerRadius = UDim.new(0, 6)
getCorner.Parent = getkey

getkey.MouseButton1Click:Connect(function()
    local keyLink = "https://discord.gg/vfSYaEX5"
    if setclipboard then
        setclipboard(keyLink)
        StarterGui:SetCore("SendNotification", {
            Title = "Discord Link Copied!",
            Text = "Head over to #get-scripts",
            Duration = 4
        })
    end
end)

-- Remember Key toggle
local rememberFrame = Instance.new("Frame")
rememberFrame.Size = UDim2.new(1, -40, 0, 25)
rememberFrame.Position = UDim2.new(0, 20, 0, 155)
rememberFrame.BackgroundTransparency = 1
rememberFrame.Parent = frame

local rememberLabel = Instance.new("TextLabel")
rememberLabel.Size = UDim2.new(0.8, 0, 1, 0)
rememberLabel.BackgroundTransparency = 1
rememberLabel.Text = "Remember Key"
rememberLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
rememberLabel.Font = Enum.Font.Gotham
rememberLabel.TextSize = 14
rememberLabel.TextXAlignment = Enum.TextXAlignment.Left
rememberLabel.Parent = rememberFrame

local checkbox = Instance.new("Frame")
checkbox.Size = UDim2.new(0, 20, 0, 20)
checkbox.Position = UDim2.new(0.8, 0, 0, 2)
checkbox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
checkbox.Parent = rememberFrame
local checkboxCorner = Instance.new("UICorner")
checkboxCorner.CornerRadius = UDim.new(0, 4)
checkboxCorner.Parent = checkbox

local tick = Instance.new("Frame")
tick.Size = UDim2.new(0, 0, 0, 0)
tick.Position = UDim2.new(0, 2, 0, 2)
tick.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
tick.Parent = checkbox
local tickCorner = Instance.new("UICorner")
tickCorner.CornerRadius = UDim.new(0, 2)
tickCorner.Parent = tick

local checkboxBtn = Instance.new("TextButton")
checkboxBtn.Size = UDim2.new(1, 0, 1, 0)
checkboxBtn.BackgroundTransparency = 1
checkboxBtn.Text = ""
checkboxBtn.Parent = checkbox

local rememberState = false
local savedKey = player:GetAttribute("SavedKey")

if savedKey then
    box.Text = savedKey
    rememberState = true
    tick:TweenSize(UDim2.new(1, -4, 1, -4), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
end

checkboxBtn.MouseButton1Click:Connect(function()
    rememberState = not rememberState
    if rememberState then
        tick:TweenSize(UDim2.new(1, -4, 1, -4), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
    else
        tick:TweenSize(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
    end
end)

-- Key check logic
check.MouseButton1Click:Connect(function()
    if box.Text == correctKey then
        if rememberState then
            player:SetAttribute("SavedKey", box.Text)
        else
            player:SetAttribute("SavedKey", nil)
        end

        if tostring(game.GameId) == allowedGameId then
            StarterGui:SetCore("SendNotification", {
                Title = "Key Accepted",
                Text = "Loading script...",
                Duration = 3
            })
            gui:Destroy()
            blur:Destroy()

            local url = gameScripts[allowedGameId]
            loadstring(game:HttpGet(url))()

        else
            StarterGui:SetCore("SendNotification", {
                Title = "Wrong Game",
                Text = "This script cannot run here.",
                Duration = 4
            })
        end

    else
        StarterGui:SetCore("SendNotification", {
            Title = "Invalid Key",
            Text = "Please enter the correct key.",
            Duration = 3
        })
    end
end)
