-- Prevent the key GUI from reopening if already verified
if _G.DK_HubKeyVerified then return end

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")
local player = Players.LocalPlayer

-- ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "DK_HUB_GUI"
screenGui.DisplayOrder = 10
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Sound
local sound = Instance.new("Sound")
sound.SoundId = "rbxassetid://6979299092"
sound.Volume = 1
sound.Parent = screenGui
sound:Play()
sound.Ended:Connect(function()
    sound:Destroy()
end)

-- Blur effect
local blurEffect = Instance.new("BlurEffect")
blurEffect.Size = 100
blurEffect.Parent = Lighting

-- Main frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0.32, 0, 0.32, 0)
frame.Position = UDim2.new(0.5, 0, 0, 0)
frame.AnchorPoint = Vector2.new(0.5, 0)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Visible = false
frame.Parent = screenGui

local frameCorner = Instance.new("UICorner", frame)
frameCorner.CornerRadius = UDim.new(0.05, 0)

-- Glow stroke
local glowStroke = Instance.new("UIStroke", frame)
glowStroke.Thickness = 3
glowStroke.Transparency = 0.8
glowStroke.Color = Color3.fromRGB(0, 128, 0)

local gradient = Instance.new("UIGradient", glowStroke)
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 0, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 0, 139))
}
gradient.Rotation = 45

-- Tween show frame
local tweenShowFrame = TweenService:Create(frame, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {Position = UDim2.new(0.5, 0, 0.3, 0)})

-- Glow effect tween
local function createGlowEffect(stroke)
    local tweenInfo = TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
    local tween = TweenService:Create(stroke, tweenInfo, {Transparency = 0.1, Thickness = 5})
    tween:Play()
end
createGlowEffect(glowStroke)

-- Title label with shadow
local function createTextLabel(parent, text, size, pos, font, textSize)
    local label = Instance.new("TextLabel")
    label.Size = size
    label.Position = pos
    label.Text = text
    label.TextScaled = true
    label.Font = font
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.BackgroundTransparency = 1
    label.TextSize = textSize
    label.Parent = parent
    return label
end

local function createTextShadow(label)
    local shadowOffset = 2
    local shadowLabel = Instance.new("TextLabel")
    shadowLabel.Size = label.Size
    shadowLabel.Position = label.Position + UDim2.new(0, shadowOffset, 0, shadowOffset)
    shadowLabel.Text = label.Text
    shadowLabel.TextScaled = label.TextScaled
    shadowLabel.Font = label.Font
    shadowLabel.TextColor3 = Color3.fromRGB(0, 0, 0)
    shadowLabel.BackgroundTransparency = 1
    shadowLabel.TextSize = label.TextSize
    shadowLabel.TextTransparency = 0.5
    shadowLabel.Parent = label.Parent
end

local titleLabel = createTextLabel(frame, "DK's Hub", UDim2.new(1,0,0.2,0), UDim2.new(0,0,0,0), Enum.Font.GothamBold, 30)
createTextShadow(titleLabel)

local creditsLabel = createTextLabel(frame, "by They_fwdk", UDim2.new(1,0,0.075,0), UDim2.new(0,0,0.2,0), Enum.Font.Gotham, 10)
createTextShadow(creditsLabel)

-- Key input
local keyInput = Instance.new("TextBox")
keyInput.Size = UDim2.new(0.8,0,0.2,0)
keyInput.Position = UDim2.new(0.1,0,0.3,0)
keyInput.PlaceholderText = "Enter your key here..."
keyInput.TextColor3 = Color3.fromRGB(255,255,255)
keyInput.BackgroundColor3 = Color3.fromRGB(40,40,40)
keyInput.Font = Enum.Font.Gotham
keyInput.TextSize = 24
keyInput.Parent = frame

local keyInputCorner = Instance.new("UICorner", keyInput)
keyInputCorner.CornerRadius = UDim.new(0.05,0)

-- Buttons
local function createButton(parent, text, size, pos, color)
    local btn = Instance.new("TextButton")
    btn.Size = size
    btn.Position = pos
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.BackgroundColor3 = color
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 24
    btn.Parent = parent
    return btn
end

local checkKeyButton = createButton(frame, "Check Key", UDim2.new(0.6,0,0.2,0), UDim2.new(0.2,0,0.55,0), Color3.fromRGB(128,128,128))
local discordButton = createButton(frame, "Get Key!", UDim2.new(0.3,0,0.2,0), UDim2.new(0.35,0,0.8,0), Color3.fromRGB(60,60,60))
local closeButton = createButton(frame, "X", UDim2.new(0.1,0,0.1,0), UDim2.new(0.9,0,0,0), Color3.fromRGB(30,30,30))

-- Show frame
frame.Visible = true
tweenShowFrame:Play()

-- Notification system
local validKey = "Winter"
local currentNotification = nil

local function createNotification(title,message,duration,color)
    if currentNotification then currentNotification:Destroy() end
    local notification = Instance.new("Frame")
    notification.Size = UDim2.new(0,250,0,80)
    notification.Position = UDim2.new(1,-270,1,-100)
    notification.BackgroundColor3 = color or Color3.fromRGB(20,20,20)
    notification.BorderSizePixel = 0
    notification.ZIndex = 2147483647
    notification.Parent = screenGui

    local UICorner = Instance.new("UICorner",notification)
    UICorner.CornerRadius = UDim.new(0,12)

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1,0,0,25)
    titleLabel.Position = UDim2.new(0,10,0,5)
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
    titleLabel.TextSize = 18
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.TextYAlignment = Enum.TextYAlignment.Center
    titleLabel.Parent = notification

    local messageLabel = Instance.new("TextLabel")
    messageLabel.Size = UDim2.new(1,0,0,30)
    messageLabel.Position = UDim2.new(0,10,0,30)
    messageLabel.Text = message
    messageLabel.TextColor3 = Color3.fromRGB(200,200,200)
    messageLabel.TextSize = 14
    messageLabel.Font = Enum.Font.Gotham
    messageLabel.BackgroundTransparency = 1
    messageLabel.TextXAlignment = Enum.TextXAlignment.Left
    messageLabel.TextYAlignment = Enum.TextYAlignment.Center
    messageLabel.TextWrapped = true
    messageLabel.Parent = notification

    local barBackground = Instance.new("Frame",notification)
    barBackground.Size = UDim2.new(1,-20,0,5)
    barBackground.Position = UDim2.new(0,10,1,-15)
    barBackground.BackgroundColor3 = Color3.fromRGB(60,60,60)
    barBackground.BorderSizePixel = 0

    local progressBar = Instance.new("Frame",barBackground)
    progressBar.Size = UDim2.new(0,0,1,0)
    progressBar.BackgroundColor3 = Color3.fromRGB(0,0,139)
    progressBar.BorderSizePixel = 0

    currentNotification = notification

    spawn(function()
        local elapsedTime = 0
        while elapsedTime < duration do
            task.wait(0.1)
            elapsedTime += 0.1
            progressBar.Size = UDim2.new(elapsedTime/duration,0,1,0)
        end
        notification:Destroy()
        currentNotification = nil
    end)
end

-- Button connections
checkKeyButton.MouseButton1Click:Connect(function()
    if keyInput.Text == validKey then
        -- Set global flag to prevent reopening
        _G.DK_HubKeyVerified = true

        -- Destroy GUI and blur
        if screenGui then screenGui:Destroy() end
        if blurEffect then blurEffect:Destroy() end

        task.wait(0.1)
        loadstring(game:HttpGet("https://raw.githubusercontent.com/dkhub43221/scripts/refs/heads/main/Loaders",true))()
    else
        createNotification("Key Verification","Unauthorized! Try again.",5,Color3.fromRGB(30,30,30))
    end
end)

discordButton.MouseButton1Click:Connect(function()
    local discordLink = "https://discord.gg/YtHcNzNM"
    setclipboard(discordLink)
    createNotification("Discord Invite Copied!","Join the Discord and navigate to the #key channel to get the key!",4,Color3.fromRGB(30,30,30))
end)

closeButton.MouseButton1Click:Connect(function()
    if screenGui then screenGui:Destroy() end
    if blurEffect then blurEffect:Destroy() end
end)

-- Cleanup blur on respawn
player.CharacterAdded:Connect(function()
    if blurEffect then blurEffect.Size = 0 end
end)
player.CharacterRemoving:Connect(function()
    if blurEffect then blurEffect.Size = 0 end
end)
Players.PlayerAdded:Connect(function()
    if blurEffect then blurEffect.Size = 0 end
end)
